{"version":3,"sources":["utils.js","AgGrid.tsx","index.tsx"],"names":["deepMap","obj","fn","deepMapper","val","Array","isArray","map","Object","keys","reduce","res","key","mapObject","hex","c","s","i","parseInt","isNaN","Math","round","min","max","charAt","trim","substring","convertToRGB","color","onlyUnique","value","index","self","indexOf","RefreshTimeStatusBarComponent","_classCallCheck","params","eGui","eUpdateTime","_createClass","this","document","createElement","className","label","innerText","appendChild","time","Date","toTimeString","slice","AgGrid","_StreamlitComponentBa","_inherits","_super","_createSuper","props","_this$props$args$grid","_this","_this2","call","frameDtypes","api","columnApi","columnFormaters","manualUpdateRequested","clearSelectedRowsButton","allowUnsafeJsCode","gridOptions","gradientLowValueColour","gradientHighValueColour","allValuesInTable","valuesForTableOrdered","wsUrl","rowIdCol","gridContainerRef","isGridAutoHeightOn","convertJavascriptCodeOnGridOptions","convertStringToFunction","render","undefined","state","should_deselect_all_rows","deselectAll","should_update","setRowData","rowData","loadColumnsState","_jsxs","id","args","theme","ref","style","defineContainerHeight","children","_jsx","ManualUpdateButton","manual_update","onClick","e","returnGridValue","AgGridReact","onGridReady","ClearRowSelectionButton","clear_row_selection","ModuleRegistry","register","ClientSideRowModelModule","CsvExportModule","custom_css","css","styles","selector","prop","push","join","getCSS","styleSheet","type","console","log","head","addCustomCSS","enable_enterprise_modules","registerModules","ExcelExportModule","GridChartsModule","SparklinesModule","ColumnsToolPanelModule","FiltersToolPanelModule","MasterDetailModule","MenuModule","RangeSelectionModule","RichSelectModule","RowGroupingModule","SetFilterModule","MultiFilterModule","SideBarModule","StatusBarModule","ClipboardModule","LicenseManager","setLicenseKey","frame_dtypes","clear_selected_rows_button","allow_unsafe_jscode","websocket_connection_string","row_id_col","React","createRef","domLayout","JSON","parse","row_data","gridHeight","height","clear_currently_selected_rows","initialiseValuesRequiredForConditionalFormatting","columnTypes","dateColumnFilter","filter","filterParams","comparator","filterValue","cellValue","compareAsc","parseISO","numberColumnFilter","shortDateTimeFormat","valueFormatter","dateFormatter","customDateTimeFormat","column","colDef","custom_format_string","customNumericFormat","_params$column$colDef","numberFormatter","precision","_params$column$colDef2","volatilityFormatter","_params$column$colDef3","_params$column$colDef4","currencyFormatter","custom_currency_symbol","timedeltaFormat","duration","humanize","cellStyle","conditionalFormattingCellStyle","assign","warn","getRowId","data","statusBar","statusPanels","statusPanel","_this3","columnDefFieldForConditionalFormatting","columnDefs","x","includes","field","forEach","uniquValues","sort","a","b","number","valueIndex","backgroundColor","colorStart","colorEnd","colorCount","rgb","start","end","len","alpha","saida","generateColor","length","v","JS_PLACEHOLDER","match","RegExp","concat","exec","funcStr","Function","_this4","updateEvents","update_on","doReturn","element","addEventListener","debounce","columnsState","columns_state","applyColumnState","applyOrder","WebSocket","onmessage","event","replace","applyTransactionAsync","update","getStatusPanel","updateTime","columns_auto_size_mode","sizeColumnsToFit","autoSizeAllColumns","isoString","formaterString","date","format","_unused","currencySymbol","arguments","n","Number","parseFloat","toFixed","returnData","data_return_mode","forEachLeafNode","row","forEachNodeAfterFilter","group","forEachNodeAfterFilterAndSort","selected","forEachDetailGridInfo","d","_d$api","forEachNode","isSelected","returnValue","originalDtypes","selectedRows","getSelectedRows","selectedItems","getSelectedNodes","_objectSpread","rowIndex","colState","getColumnState","Streamlit","setComponentValue","_this5","idx","attachUpdateEvents","fitColumns","selectIndex","_this$gridContainerRe","renderedGridHeight","current","clientHeight","setFrameHeight","wsUpdate","width","reload_data","StreamlitComponentBase","withStreamlitConnection","ReactDOM","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.19f3a631.chunk.js","sourcesContent":["// stole from https://github.com/andfanilo/streamlit-echarts/blob/master/streamlit_echarts/frontend/src/utils.js Thanks andfanilo\nfunction mapObject(obj, fn) {\n    return Object.keys(obj).reduce((res, key) => {\n        res[key] = fn(obj[key])\n        return res\n    }, {})\n}\n\nfunction deepMap(obj, fn) {\n    const deepMapper = (val) =>\n        val !== null && typeof val === \"object\" ? deepMap(val, fn) : fn(val)\n    if (Array.isArray(obj)) {\n        return obj.map(deepMapper)\n    }\n    if (typeof obj === \"object\") {\n        return mapObject(obj, deepMapper)\n    }\n    return obj\n}\n\nexport default deepMap\n","import {Streamlit, StreamlitComponentBase, withStreamlitConnection,} from \"streamlit-component-lib\"\r\n\r\nimport React, {ReactNode} from \"react\"\r\n\r\nimport {AgGridReact} from \"@ag-grid-community/react\"\r\n\r\nimport {\r\n  ColumnApi,\r\n  DetailGridInfo,\r\n  GetRowIdParams,\r\n  GridApi,\r\n  IStatusPanelComp,\r\n  IStatusPanelParams,\r\n  ModuleRegistry\r\n} from \"@ag-grid-community/core\"\r\n\r\nimport {ClientSideRowModelModule} from \"@ag-grid-community/client-side-row-model\"\r\nimport {LicenseManager} from \"@ag-grid-enterprise/core\"\r\nimport {GridChartsModule} from \"@ag-grid-enterprise/charts\"\r\nimport {SparklinesModule} from \"@ag-grid-enterprise/sparklines\"\r\nimport {ClipboardModule} from \"@ag-grid-enterprise/clipboard\"\r\nimport {CsvExportModule} from \"@ag-grid-community/csv-export\"\r\nimport {ColumnsToolPanelModule} from \"@ag-grid-enterprise/column-tool-panel\"\r\nimport {ExcelExportModule} from \"@ag-grid-enterprise/excel-export\"\r\nimport {FiltersToolPanelModule} from \"@ag-grid-enterprise/filter-tool-panel\"\r\nimport {MasterDetailModule} from \"@ag-grid-enterprise/master-detail\"\r\nimport {MenuModule} from \"@ag-grid-enterprise/menu\"\r\nimport {RangeSelectionModule} from \"@ag-grid-enterprise/range-selection\"\r\nimport {RichSelectModule} from \"@ag-grid-enterprise/rich-select\"\r\nimport {RowGroupingModule} from \"@ag-grid-enterprise/row-grouping\"\r\nimport {SetFilterModule} from \"@ag-grid-enterprise/set-filter\"\r\nimport {MultiFilterModule} from \"@ag-grid-enterprise/multi-filter\"\r\nimport {SideBarModule} from \"@ag-grid-enterprise/side-bar\"\r\nimport {StatusBarModule} from \"@ag-grid-enterprise/status-bar\"\r\n\r\nimport {compareAsc, parseISO} from \"date-fns\"\r\nimport {format} from \"date-fns-tz\"\r\nimport deepMap from \"./utils\"\r\nimport {duration} from \"moment\"\r\n\r\nimport {debounce} from \"lodash\"\r\n\r\nimport \"./AgGrid.scss\"\r\nimport \"./scrollbar.css\"\r\n\r\ninterface State {\r\n  rowData: any\r\n  gridHeight: number\r\n  should_update: boolean\r\n  should_deselect_all_rows: boolean\r\n}\r\n\r\ntype CSSDict = { [key: string]: { [key: string]: string } }\r\n\r\nfunction getCSS(styles: CSSDict): string {\r\n  var css = []\r\n  for (let selector in styles) {\r\n    let style = selector + \" {\"\r\n\r\n    for (let prop in styles[selector]) {\r\n      style += prop + \": \" + styles[selector][prop] + \";\"\r\n    }\r\n\r\n    style += \"}\"\r\n\r\n    css.push(style)\r\n  }\r\n\r\n  return css.join(\"\\n\")\r\n}\r\n\r\nfunction addCustomCSS(custom_css: CSSDict): void {\r\n  var css = getCSS(custom_css)\r\n  var styleSheet = document.createElement(\"style\")\r\n  styleSheet.type = \"text/css\"\r\n  styleSheet.innerText = css\r\n  console.log(`Adding cutom css: `, css)\r\n  document.head.appendChild(styleSheet)\r\n}\r\n\r\nfunction hex(c: any) {\r\n  var s = '0123456789abcdef';\r\n  var i = parseInt(c);\r\n  if (isNaN(c) || i === 0) return '00';\r\n  i = Math.round(Math.min(Math.max(0, i), 255));\r\n  return s.charAt((i - (i % 16)) / 16) + s.charAt(i % 16);\r\n}\r\n\r\n/* Convert an RGB triplet to a hex string */\r\nfunction convertToHex(rgb: any) {\r\n  return hex(rgb[0]) + hex(rgb[1]) + hex(rgb[2]);\r\n}\r\n\r\n/* Remove '#' in color hex string */\r\nfunction trim(s: string) {\r\n  return s.charAt(0) === '#' ? s.substring(1, 7) : s;\r\n}\r\n\r\n/* Convert a hex string to an RGB triplet */\r\nfunction convertToRGB(hex: string) {\r\n  var color = [];\r\n  color[0] = parseInt(trim(hex).substring(0, 2), 16);\r\n  color[1] = parseInt(trim(hex).substring(2, 4), 16);\r\n  color[2] = parseInt(trim(hex).substring(4, 6), 16);\r\n  return color;\r\n}\r\n\r\nfunction generateColor(colorStart: string, colorEnd: string, colorCount: number, index: number) {\r\n  // The beginning of your gradient\r\n  var start = convertToRGB(colorStart);\r\n\r\n  // The end of your gradient\r\n  var end = convertToRGB(colorEnd);\r\n\r\n  // The number of colors to compute\r\n  var len = colorCount;\r\n\r\n  //Alpha blending amount\r\n  var alpha = 0.0;\r\n\r\n  var saida = [];\r\n\r\n  let i;\r\n  for (i = 0; i < len; i++) {\r\n    var c = [];\r\n    alpha += 1.0 / len;\r\n\r\n    c[0] = start[0] * alpha + (1 - alpha) * end[0];\r\n    c[1] = start[1] * alpha + (1 - alpha) * end[1];\r\n    c[2] = start[2] * alpha + (1 - alpha) * end[2];\r\n\r\n    saida.push(convertToHex(c));\r\n  }\r\n\r\n  return saida[index];\r\n}\r\n\r\nfunction onlyUnique(value: any, index: any, self: any) {\r\n  if (value !== 'nan') {\r\n    return self.indexOf(value) === index;\r\n  }\r\n}\r\n\r\n\r\nexport class RefreshTimeStatusBarComponent implements IStatusPanelComp {\r\n  params!: IStatusPanelParams;\r\n  eGui!: HTMLDivElement;\r\n  eUpdateTime!: HTMLSpanElement;\r\n\r\n  init(params: IStatusPanelParams) {\r\n    this.params = params;\r\n\r\n    this.eGui = document.createElement('div');\r\n    this.eGui.className = 'ag-status-name-value';\r\n\r\n    var label = document.createElement('span');\r\n    label.innerText = 'Last Refresh Time: ';\r\n    this.eGui.appendChild(label);\r\n\r\n    this.eUpdateTime = document.createElement('span');\r\n    this.eUpdateTime.className = 'ag-status-name-value-value';\r\n\r\n    this.eGui.appendChild(this.eUpdateTime);\r\n\r\n  }\r\n\r\n  getGui() {\r\n    return this.eGui;\r\n  }\r\n\r\n  destroy() {\r\n  }\r\n\r\n  updateTime() {\r\n    var today = new Date();\r\n    // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/toTimeString\r\n    var time=today.toTimeString().slice(0,8)\r\n    this.eUpdateTime.innerText = time + '';\r\n  }\r\n}\r\n\r\nclass AgGrid extends StreamlitComponentBase<State> {\r\n  private frameDtypes: any\r\n  private api!: GridApi\r\n  private columnApi!: ColumnApi\r\n  private columnFormaters: any\r\n  private manualUpdateRequested: boolean = false\r\n  private clearSelectedRowsButton: boolean = false\r\n  private allowUnsafeJsCode: boolean = false\r\n  private gridOptions: any\r\n  private gradientLowValueColour = '#FF0000'\r\n  private gradientHighValueColour = '#00FF00'\r\n  private allValuesInTable: number[] = []\r\n  private valuesForTableOrdered: number[] = []\r\n  private wsUrl: string\r\n  private rowIdCol: string\r\n  private gridContainerRef: React.RefObject<HTMLDivElement>\r\n  private isGridAutoHeightOn: boolean\r\n\r\n  constructor(props: any) {\r\n    super(props)\r\n    ModuleRegistry.register(ClientSideRowModelModule)\r\n    ModuleRegistry.register(CsvExportModule)\r\n\r\n    if (props.args.custom_css) {\r\n      addCustomCSS(props.args.custom_css)\r\n    }\r\n\r\n    if (props.args.enable_enterprise_modules) {\r\n      ModuleRegistry.registerModules([\r\n        ExcelExportModule,\r\n        GridChartsModule,\r\n        SparklinesModule,\r\n        ColumnsToolPanelModule,\r\n        FiltersToolPanelModule,\r\n        MasterDetailModule,\r\n        MenuModule,\r\n        RangeSelectionModule,\r\n        RichSelectModule,\r\n        RowGroupingModule,\r\n        SetFilterModule,\r\n        MultiFilterModule,\r\n        SideBarModule,\r\n        StatusBarModule,\r\n        ClipboardModule,\r\n      ])\r\n      if (\"license_key\" in props.args) {\r\n        LicenseManager.setLicenseKey(props.args[\"license_key\"])\r\n      }\r\n    }\r\n\r\n    this.frameDtypes = this.props.args.frame_dtypes\r\n    this.manualUpdateRequested = this.props.args.manual_update === 1\r\n    this.clearSelectedRowsButton = this.props.args.clear_selected_rows_button\r\n    this.allowUnsafeJsCode = this.props.args.allow_unsafe_jscode\r\n    this.wsUrl = this.props.args.websocket_connection_string\r\n    this.rowIdCol = this.props.args.row_id_col\r\n    this.gridContainerRef = React.createRef();\r\n    this.isGridAutoHeightOn = this.props.args.gridOptions?.domLayout === \"autoHeight\"\r\n\r\n    this.state = {\r\n      rowData: JSON.parse(props.args.row_data),\r\n      gridHeight: this.props.args.height,\r\n      should_update: false,\r\n      should_deselect_all_rows: props.args.clear_currently_selected_rows,\r\n    }\r\n\r\n    this.initialiseValuesRequiredForConditionalFormatting(this.props.args.gridOptions, this.state.rowData)\r\n\r\n    this.columnFormaters = {\r\n      columnTypes: {\r\n        dateColumnFilter: {\r\n          filter: \"agDateColumnFilter\",\r\n          filterParams: {\r\n            comparator: (filterValue: any, cellValue: string) =>\r\n              compareAsc(parseISO(cellValue), filterValue),\r\n          },\r\n        },\r\n        numberColumnFilter: {\r\n          filter: \"agNumberColumnFilter\",\r\n        },\r\n        shortDateTimeFormat: {\r\n          valueFormatter: (params: any) =>\r\n            this.dateFormatter(params.value, \"dd/MM/yyyy HH:mm\"),\r\n        },\r\n        'customDateFormat': {\r\n          valueFormatter: (params: any) =>\r\n              this.dateFormatter(params.value, \"yyyy-MM-dd\"),\r\n        },\r\n        customDateTimeFormat: {\r\n          valueFormatter: (params: any) =>\r\n            this.dateFormatter(\r\n              params.value,\r\n              params.column.colDef.custom_format_string\r\n            ),\r\n        },\r\n        customNumericFormat: {\r\n          valueFormatter: (params: any) =>\r\n            this.numberFormatter(\r\n              params.value,\r\n              params.column.colDef.precision ?? 2\r\n            ),\r\n        },\r\n        'customVolatilityFormat': {\r\n          valueFormatter: (params: any) => this.volatilityFormatter(params.value, params.column.colDef.precision ?? 1),\r\n        },\r\n        'customCurrencyFormat': {\r\n          valueFormatter: (params: any) =>\r\n              this.currencyFormatter(\r\n                  params.value,\r\n                  params.column.colDef.custom_currency_symbol ?? '$',\r\n                  params.column.colDef.precision ?? 0\r\n              ),\r\n        },\r\n        timedeltaFormat: {\r\n          valueFormatter: (params: any) =>\r\n            duration(params.value).humanize(true),\r\n        },\r\n        'conditionalFormat': {\r\n          cellStyle: (params: any) => this.conditionalFormattingCellStyle(params.value, this.valuesForTableOrdered)\r\n        },\r\n      }\r\n    }\r\n\r\n    let gridOptions = Object.assign(\r\n        {},\r\n        this.columnFormaters,\r\n        this.props.args.gridOptions\r\n    )\r\n\r\n    if (this.allowUnsafeJsCode) {\r\n      console.warn(\"flag allow_unsafe_jscode is on.\")\r\n      gridOptions = this.convertJavascriptCodeOnGridOptions(gridOptions)\r\n    }\r\n    if (this.rowIdCol !== null) {\r\n      gridOptions.getRowId = (params: GetRowIdParams) => {\r\n        // console.log(this.rowIdCol)\r\n        // console.log(params.data)\r\n        // console.log(params.data[this.rowIdCol])\r\n        // console.log(params.data.ExpirationDate)\r\n        return params.data[this.rowIdCol];\r\n      }\r\n\r\n    }\r\n\r\n    if (this.wsUrl !== null) {\r\n\r\n      gridOptions.statusBar = {\r\n        statusPanels: [\r\n          {\r\n            statusPanel: RefreshTimeStatusBarComponent,\r\n            key: 'refreshTimeCompKey',\r\n          },\r\n        ],\r\n      }\r\n    }\r\n    this.gridOptions = gridOptions\r\n  }\r\n\r\n\r\n  private initialiseValuesRequiredForConditionalFormatting(gridOptions: any, rowData: any) {\r\n    const columnDefs = gridOptions.columnDefs;\r\n    // console.log(columnDefs)\r\n    const columnDefFieldForConditionalFormatting = columnDefs\r\n        // .filter((x:any) => x.cellStyle?.name === 'conditionalFormattingCellStyle')\r\n        // .filter((x:any) =>  x.conditional_formatting_group === 'group1')\r\n        .filter((x: any) => x.type.includes('conditionalFormat'))\r\n        .map((x: any) => {\r\n          if (x.field) {\r\n            return x.field;\r\n          }\r\n        });\r\n    // console.log(columnDefFieldForConditionalFormatting)\r\n    rowData.forEach((x: any) => {\r\n      columnDefFieldForConditionalFormatting.forEach((field: any) => {\r\n        this.allValuesInTable.push(x[field]);\r\n      })\r\n    });\r\n    // console.log(this.allValuesInTable)\r\n    // const uniquValues = [...new Set(this.allValuesInTable)];\r\n    const uniquValues = this.allValuesInTable.filter(onlyUnique)//.filter((x:any)=>x!=='nan');\r\n\r\n    this.valuesForTableOrdered = uniquValues.sort(function (a, b) {\r\n      return a - b;\r\n    });\r\n    // console.log(this.valuesForTableOrdered)\r\n  }\r\n\r\n  private conditionalFormattingCellStyle(number: any, valuesForTableOrdered: any) {\r\n    // the index, or how far along the value is in the gradient\r\n    const valueIndex = valuesForTableOrdered.indexOf(number);\r\n    // get the colour for the cell, depending on its index\r\n    const bgColour = generateColor(\r\n        this.gradientHighValueColour,\r\n        this.gradientLowValueColour,\r\n        this.valuesForTableOrdered.length,\r\n        valueIndex\r\n    );\r\n\r\n    return {backgroundColor: '#' + bgColour};\r\n  }\r\n\r\n  static getDerivedStateFromProps(props: any, state: any) {\r\n    if (props.args.reload_data) {\r\n      let new_row_data = JSON.parse(props.args.row_data)\r\n\r\n      return {\r\n        rowData: new_row_data,\r\n        gridHeight: props.args.height,\r\n        should_update: true,\r\n        should_deselect_all_rows:props.args.clear_currently_selected_rows,\r\n      }\r\n    } else {\r\n      return {\r\n        gridHeight: props.args.height,\r\n        should_deselect_all_rows:props.args.clear_currently_selected_rows,\r\n      }\r\n    }\r\n  }\r\n\r\n  private convertStringToFunction(v: string) {\r\n    const JS_PLACEHOLDER = \"--x_x--0_0--\"\r\n\r\n    let funcReg = new RegExp(\r\n      `${JS_PLACEHOLDER}\\\\s*((function|class)\\\\s*.*)\\\\s*${JS_PLACEHOLDER}`\r\n    )\r\n\r\n    let match = funcReg.exec(v)\r\n\r\n    if (match) {\r\n      const funcStr = match[1]\r\n      // eslint-disable-next-line\r\n      return new Function(\"return \" + funcStr)()\r\n    } else {\r\n      return v\r\n    }\r\n  }\r\n\r\n  private convertJavascriptCodeOnGridOptions = (obj: object) => {\r\n    return deepMap(obj, this.convertStringToFunction)\r\n  }\r\n\r\n  private attachUpdateEvents(api: GridApi) {\r\n    let updateEvents = this.props.args.update_on[0]\r\n    const doReturn = (e: any) => this.returnGridValue(e)\r\n\r\n    updateEvents.forEach((element: any) => {\r\n      if (Array.isArray(element)) {\r\n        api.addEventListener(element[0], debounce(doReturn, element[1]))\r\n        console.log(\"Attached arr\", element)\r\n      } else {\r\n        api.addEventListener(element, doReturn)\r\n      }\r\n    })\r\n  }\r\n\r\n  private loadColumnsState() {\r\n    const columnsState = this.props.args.columns_state\r\n\r\n    if (columnsState != null) {\r\n      //console.dir(columnsState)\r\n      this.columnApi.applyColumnState({state: columnsState, applyOrder: true})\r\n    }\r\n  }\r\n\r\n  public render = (): ReactNode => {\r\n    if (this.api !== undefined) {\r\n      if (this.state.should_deselect_all_rows){\r\n        this.api.deselectAll()\r\n      }\r\n      if (this.state.should_update) {\r\n        this.api.setRowData(this.state.rowData)\r\n      }\r\n    }\r\n    this.loadColumnsState()\r\n\r\n\r\n    return (\r\n        <div\r\n            id=\"gridContainer\"\r\n            className={\"ag-theme-\" + this.props.args.theme}\r\n            ref={this.gridContainerRef}\r\n            style={this.defineContainerHeight()}\r\n        >\r\n          <this.ManualUpdateButton\r\n              manual_update={this.manualUpdateRequested}\r\n              onClick={(e: any) => this.returnGridValue(e)}\r\n          />\r\n          <AgGridReact\r\n              onGridReady={(e) => this.onGridReady(e)}\r\n              gridOptions={this.gridOptions}\r\n          ></AgGridReact>\r\n          <this.ClearRowSelectionButton\r\n              clear_row_selection={this.clearSelectedRowsButton}\r\n              onClick={(e: any) => this.api.deselectAll()}\r\n          />\r\n        </div>\r\n    )\r\n  }\r\n\r\n  private wsUpdate(api: any) {\r\n    let ws = new WebSocket(this.wsUrl);\r\n    ws.onmessage = function (event) {\r\n      let data = JSON.parse(event.data.replace(/\\bNaN\\b/g, \"null\"))\r\n      // console.log(data)\r\n      api.applyTransactionAsync({update: data})\r\n      const updateTimeComponent = api!.getStatusPanel('refreshTimeCompKey') as any;\r\n      updateTimeComponent.updateTime();\r\n    }\r\n  }\r\n\r\n  private fitColumns() {\r\n    const columns_auto_size_mode = this.props.args.columns_auto_size_mode\r\n\r\n    switch (columns_auto_size_mode) {\r\n      case 1:\r\n      case \"FIT_ALL_COLUMNS_TO_VIEW\":\r\n        this.api.sizeColumnsToFit()\r\n        break\r\n\r\n      case 2:\r\n      case \"FIT_CONTENTS\":\r\n        this.columnApi.autoSizeAllColumns()\r\n        break\r\n\r\n      default:\r\n        break\r\n    }\r\n  }\r\n\r\n  private dateFormatter(isoString: string, formaterString: string): String {\r\n    try {\r\n      let date = parseISO(isoString)\r\n      return format(date, formaterString)\r\n    } catch {\r\n      return isoString\r\n    } finally {\r\n    }\r\n  }\r\n\r\n  private currencyFormatter(number: any, currencySymbol: string, precision: number = 0): String {\r\n    let n = Number.parseFloat(number)\r\n    if (!Number.isNaN(n)) {\r\n      return currencySymbol + n.toFixed(precision).replace(/(\\d)(?=(\\d{3})+(?!\\d))/g, '$1,')\r\n    } else {\r\n      return number\r\n    }\r\n  }\r\n\r\n  private numberFormatter(number: any, precision: number): String {\r\n    let n = Number.parseFloat(number)\r\n    if (!Number.isNaN(n)) {\r\n      return n.toFixed(precision)\r\n    } else {\r\n      return number\r\n    }\r\n  }\r\n\r\n  private volatilityFormatter(number: any, precision: number): String {\r\n    let n = Number.parseFloat(number)\r\n    if (!Number.isNaN(n)) {\r\n      return (n * 100).toFixed(precision) + '%'\r\n    } else {\r\n      return number\r\n    }\r\n  }\r\n\r\n  private returnGridValue(e: any) {\r\n    let returnData: any[] = []\r\n    let returnMode = this.props.args.data_return_mode\r\n\r\n    switch (returnMode) {\r\n      case 0: //ALL_DATA\r\n        this.api.forEachLeafNode((row) => returnData.push(row.data))\r\n        break\r\n\r\n      case 1: //FILTERED_DATA\r\n        this.api.forEachNodeAfterFilter((row) => {\r\n          if (!row.group) {\r\n            returnData.push(row.data)\r\n          }\r\n        })\r\n        break\r\n\r\n      case 2: //FILTERED_SORTED_DATA\r\n        this.api.forEachNodeAfterFilterAndSort((row) => {\r\n          if (!row.group) {\r\n            returnData.push(row.data)\r\n          }\r\n        })\r\n        break\r\n    }\r\n\r\n      let selected : any  = {}\r\n      this.api.forEachDetailGridInfo((d:DetailGridInfo) => {\r\n        selected[d.id] = []\r\n        d.api?.forEachNode((n: any) => {\r\n          if (n.isSelected()) {\r\n            selected[d.id].push(n)\r\n          }\r\n        })\r\n      })\r\n\r\n    //console.log(selected)\r\n    let returnValue = {\r\n      originalDtypes: this.frameDtypes,\r\n      rowData: returnData,\r\n      selectedRows: this.api.getSelectedRows(),\r\n      selectedItems: this.api\r\n        .getSelectedNodes()\r\n        .map((n) => ({ rowIndex: n.rowIndex, ...n.data })),\r\n      colState: this.columnApi.getColumnState(),\r\n    }\r\n\r\n    Streamlit.setComponentValue(returnValue)\r\n  }\r\n\r\n  private ManualUpdateButton(props: any) {\r\n    if (props.manual_update) {\r\n      return <button onClick={props.onClick}>Update</button>\r\n    } else {\r\n      return <span></span>\r\n    }\r\n  }\r\n\r\n  private onGridReady(event: any) {\r\n    this.api = event.api\r\n    this.columnApi = event.columnApi\r\n\r\n    this.api.forEachDetailGridInfo((i: any) => {\r\n      console.log(i)\r\n    })\r\n\r\n    this.attachUpdateEvents(this.api)\r\n\r\n    this.api.forEachDetailGridInfo((i: DetailGridInfo) => {\r\n      //console.log(i)\r\n      if (i.api !== undefined) {\r\n        this.attachUpdateEvents(i.api)\r\n      }\r\n    })\r\n\r\n    this.api.addEventListener(\"firstDataRendered\", (e: any) =>\r\n        this.fitColumns()\r\n    )\r\n\r\n    this.api.setRowData(this.state.rowData)\r\n\r\n    for (var idx in this.gridOptions[\"preSelectedRows\"]) {\r\n      this.api.selectIndex(this.gridOptions[\"preSelectedRows\"][idx], true, true)\r\n    }\r\n    if (this.isGridAutoHeightOn) {\r\n      const renderedGridHeight = this.gridContainerRef.current?.clientHeight\r\n      Streamlit.setFrameHeight(renderedGridHeight)\r\n    }\r\n    if (this.wsUrl !== null) {\r\n      // console.log(this.state.rowData)\r\n      this.wsUpdate(this.api)\r\n    }\r\n\r\n  }\r\n\r\n  private defineContainerHeight() {\r\n    if (this.isGridAutoHeightOn) {\r\n      return {\r\n        width: this.props.width,\r\n      }\r\n    } else {\r\n      return {\r\n        width: this.props.width,\r\n        height: this.state.gridHeight,\r\n      }\r\n    }\r\n  }\r\n\r\n  private ClearRowSelectionButton(props: any) {\r\n    if (props.clear_row_selection) {\r\n      return <button onClick={props.onClick}>Clear Row Selection</button>\r\n    } else {\r\n      return <span></span>\r\n    }\r\n  }\r\n}\r\n\r\nexport default withStreamlitConnection(AgGrid)\r\n","import React from \"react\"\nimport ReactDOM from \"react-dom\"\nimport AgGrid from \"./AgGrid\"\n\nReactDOM.render(\n  <React.StrictMode>\n    <AgGrid />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n)\n"],"sourceRoot":""}