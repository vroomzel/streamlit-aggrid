(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{341:function(e,t,a){},342:function(e,t,a){},344:function(e,t,a){"use strict";a.r(t);var r=a(36),n=a.n(r),i=a(118),o=a.n(i),s=a(33),u=a(5),l=a(6),c=a(2),d=a(3),p=a(123),m=a(255),h=a(0),f=a(262),v=a(35),g=a(259),y=a(260),b=a(271),F=a(30),w=a(217),O=a(261),C=a(266),_=a(268),j=a(267),k=a(218),R=a(269),S=a(69),T=a(265),N=a(270),D=a(117),x=a(263),A=a(347),U=a(346),E=a(264);var G=function e(t,a){var r=function(t){return null!==t&&"object"===typeof t?e(t,a):a(t)};return Array.isArray(t)?t.map(r):"object"===typeof t?function(e,t){return Object.keys(e).reduce((function(a,r){return a[r]=t(e[r]),a}),{})}(t,r):t},I=a(257),H=a(258),M=(a(341),a(342),a(61));function V(e){var t="0123456789abcdef",a=parseInt(e);return isNaN(e)||0===a?"00":(a=Math.round(Math.min(Math.max(0,a),255)),t.charAt((a-a%16)/16)+t.charAt(a%16))}function L(e){return"#"===e.charAt(0)?e.substring(1,7):e}function J(e){var t=[];return t[0]=parseInt(L(e).substring(0,2),16),t[1]=parseInt(L(e).substring(2,4),16),t[2]=parseInt(L(e).substring(4,6),16),t}function B(e,t,a){if("nan"!==e)return a.indexOf(e)===t}var q=function(){function e(){Object(c.a)(this,e),this.params=void 0,this.eGui=void 0,this.eUpdateTime=void 0}return Object(d.a)(e,[{key:"init",value:function(e){this.params=e,this.eGui=document.createElement("div"),this.eGui.className="ag-status-name-value";var t=document.createElement("span");t.innerText="Last Refresh Time: ",this.eGui.appendChild(t),this.eUpdateTime=document.createElement("span"),this.eUpdateTime.className="ag-status-name-value-value",this.eGui.appendChild(this.eUpdateTime)}},{key:"getGui",value:function(){return this.eGui}},{key:"destroy",value:function(){}},{key:"updateTime",value:function(){var e=(new Date).toTimeString().slice(0,8);this.eUpdateTime.innerText=e+""}}]),e}(),P=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(e){var r,i,o=this;Object(c.a)(this,a),(i=t.call(this,e)).frameDtypes=void 0,i.api=void 0,i.columnApi=void 0,i.columnFormaters=void 0,i.manualUpdateRequested=!1,i.clearSelectedRowsButton=!1,i.allowUnsafeJsCode=!1,i.gridOptions=void 0,i.gradientLowValueColour="#FF0000",i.gradientHighValueColour="#00FF00",i.allValuesInTable=[],i.valuesForTableOrdered=[],i.wsUrl=void 0,i.rowIdCol=void 0,i.gridContainerRef=void 0,i.isGridAutoHeightOn=void 0,i.convertJavascriptCodeOnGridOptions=function(e){return G(e,i.convertStringToFunction)},i.render=function(){return void 0!==i.api&&i.state.should_update&&i.api.setRowData(i.state.rowData),i.loadColumnsState(),Object(M.jsxs)("div",{id:"gridContainer",className:"ag-theme-"+i.props.args.theme,ref:i.gridContainerRef,style:i.defineContainerHeight(),children:[Object(M.jsx)(o.ManualUpdateButton,{manual_update:i.manualUpdateRequested,onClick:function(e){return i.returnGridValue(e)}}),Object(M.jsx)(m.AgGridReact,{onGridReady:function(e){return i.onGridReady(e)},gridOptions:i.gridOptions}),Object(M.jsx)(o.ClearRowSelectionButton,{clear_row_selection:i.clearSelectedRowsButton,onClick:function(e){return i.api.deselectAll()}})]})},h.ModuleRegistry.register(f.a),h.ModuleRegistry.register(F.d),e.args.custom_css&&function(e){var t=function(e){var t=[];for(var a in e){var r=a+" {";for(var n in e[a])r+=n+": "+e[a][n]+";";r+="}",t.push(r)}return t.join("\n")}(e),a=document.createElement("style");a.type="text/css",a.innerText=t,console.log("Adding cutom css: ",t),document.head.appendChild(a)}(e.args.custom_css),e.args.enable_enterprise_modules&&(h.ModuleRegistry.registerModules([O.a,g.a,y.a,w.a,C.a,_.a,j.a,k.a,R.a,S.c,T.a,N.a,D.a,x.a,b.a]),"license_key"in e.args&&v.b.setLicenseKey(e.args.license_key)),i.frameDtypes=i.props.args.frame_dtypes,i.manualUpdateRequested=1===i.props.args.manual_update,i.clearSelectedRowsButton=i.props.args.clear_selected_rows_button,i.allowUnsafeJsCode=i.props.args.allow_unsafe_jscode,i.wsUrl=i.props.args.websocket_connection_string,i.rowIdCol=i.props.args.row_id_col,i.gridContainerRef=n.a.createRef(),i.isGridAutoHeightOn="autoHeight"===(null===(r=i.props.args.gridOptions)||void 0===r?void 0:r.domLayout),i.state={rowData:JSON.parse(e.args.row_data),gridHeight:i.props.args.height,should_update:!1},i.initialiseValuesRequiredForConditionalFormatting(i.props.args.gridOptions,i.state.rowData),i.columnFormaters={columnTypes:{dateColumnFilter:{filter:"agDateColumnFilter",filterParams:{comparator:function(e,t){return Object(A.a)(Object(U.a)(t),e)}}},numberColumnFilter:{filter:"agNumberColumnFilter"},shortDateTimeFormat:{valueFormatter:function(e){return i.dateFormatter(e.value,"dd/MM/yyyy HH:mm")}},customDateFormat:{valueFormatter:function(e){return i.dateFormatter(e.value,"yyyy-MM-dd")}},customDateTimeFormat:{valueFormatter:function(e){return i.dateFormatter(e.value,e.column.colDef.custom_format_string)}},customNumericFormat:{valueFormatter:function(e){var t;return i.numberFormatter(e.value,null!==(t=e.column.colDef.precision)&&void 0!==t?t:2)}},customVolatilityFormat:{valueFormatter:function(e){var t;return i.volatilityFormatter(e.value,null!==(t=e.column.colDef.precision)&&void 0!==t?t:1)}},customCurrencyFormat:{valueFormatter:function(e){var t,a;return i.currencyFormatter(e.value,null!==(t=e.column.colDef.custom_currency_symbol)&&void 0!==t?t:"$",null!==(a=e.column.colDef.precision)&&void 0!==a?a:0)}},timedeltaFormat:{valueFormatter:function(e){return Object(I.duration)(e.value).humanize(!0)}},conditionalFormat:{cellStyle:function(e){return i.conditionalFormattingCellStyle(e.value,i.valuesForTableOrdered)}}}};var s=Object.assign({},i.columnFormaters,i.props.args.gridOptions);return i.allowUnsafeJsCode&&(console.warn("flag allow_unsafe_jscode is on."),s=i.convertJavascriptCodeOnGridOptions(s)),null!==i.rowIdCol&&(s.getRowId=function(e){return e.data[i.rowIdCol]}),null!==i.wsUrl&&(s.statusBar={statusPanels:[{statusPanel:q,key:"refreshTimeCompKey"}]}),i.gridOptions=s,i}return Object(d.a)(a,[{key:"initialiseValuesRequiredForConditionalFormatting",value:function(e,t){var a=this,r=e.columnDefs.filter((function(e){return e.type.includes("conditionalFormat")})).map((function(e){if(e.field)return e.field}));t.forEach((function(e){r.forEach((function(t){a.allValuesInTable.push(e[t])}))}));var n=this.allValuesInTable.filter(B);this.valuesForTableOrdered=n.sort((function(e,t){return e-t}))}},{key:"conditionalFormattingCellStyle",value:function(e,t){var a=t.indexOf(e);return{backgroundColor:"#"+function(e,t,a,r){var n,i,o=J(e),s=J(t),u=a,l=0,c=[];for(n=0;n<u;n++){var d=[];l+=1/u,d[0]=o[0]*l+(1-l)*s[0],d[1]=o[1]*l+(1-l)*s[1],d[2]=o[2]*l+(1-l)*s[2],c.push(V((i=d)[0])+V(i[1])+V(i[2]))}return c[r]}(this.gradientHighValueColour,this.gradientLowValueColour,this.valuesForTableOrdered.length,a)}}},{key:"convertStringToFunction",value:function(e){var t="--x_x--0_0--",a=new RegExp("".concat(t,"\\s*((function|class)\\s*.*)\\s*").concat(t)).exec(e);if(a){var r=a[1];return new Function("return "+r)()}return e}},{key:"attachUpdateEvents",value:function(e){var t=this,a=this.props.args.update_on[0],r=function(e){return t.returnGridValue(e)};a.forEach((function(t){Array.isArray(t)?(e.addEventListener(t[0],Object(H.debounce)(r,t[1])),console.log("Attached arr",t)):e.addEventListener(t,r)}))}},{key:"loadColumnsState",value:function(){var e=this.props.args.columns_state;null!=e&&this.columnApi.applyColumnState({state:e,applyOrder:!0})}},{key:"wsUpdate",value:function(e){new WebSocket(this.wsUrl).onmessage=function(t){var a=JSON.parse(t.data.replace(/\bNaN\b/g,"null"));e.applyTransactionAsync({update:a}),e.getStatusPanel("refreshTimeCompKey").updateTime()}}},{key:"fitColumns",value:function(){switch(this.props.args.columns_auto_size_mode){case 1:case"FIT_ALL_COLUMNS_TO_VIEW":this.api.sizeColumnsToFit();break;case 2:case"FIT_CONTENTS":this.columnApi.autoSizeAllColumns()}}},{key:"dateFormatter",value:function(e,t){try{var a=Object(U.a)(e);return Object(E.a)(a,t)}catch(r){return e}}},{key:"currencyFormatter",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=Number.parseFloat(e);return Number.isNaN(r)?e:t+r.toFixed(a).replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")}},{key:"numberFormatter",value:function(e,t){var a=Number.parseFloat(e);return Number.isNaN(a)?e:a.toFixed(t)}},{key:"volatilityFormatter",value:function(e,t){var a=Number.parseFloat(e);return Number.isNaN(a)?e:(100*a).toFixed(t)+"%"}},{key:"returnGridValue",value:function(e){var t=[];switch(this.props.args.data_return_mode){case 0:this.api.forEachLeafNode((function(e){return t.push(e.data)}));break;case 1:this.api.forEachNodeAfterFilter((function(e){e.group||t.push(e.data)}));break;case 2:this.api.forEachNodeAfterFilterAndSort((function(e){e.group||t.push(e.data)}))}var a={};this.api.forEachDetailGridInfo((function(e){var t;a[e.id]=[],null===(t=e.api)||void 0===t||t.forEachNode((function(t){t.isSelected()&&a[e.id].push(t)}))}));var r={originalDtypes:this.frameDtypes,rowData:t,selectedRows:this.api.getSelectedRows(),selectedItems:this.api.getSelectedNodes().map((function(e){return Object(s.a)({rowIndex:e.rowIndex},e.data)})),colState:this.columnApi.getColumnState()};p.a.setComponentValue(r)}},{key:"ManualUpdateButton",value:function(e){return e.manual_update?Object(M.jsx)("button",{onClick:e.onClick,children:"Update"}):Object(M.jsx)("span",{})}},{key:"onGridReady",value:function(e){var t=this;for(var a in this.api=e.api,this.columnApi=e.columnApi,this.api.forEachDetailGridInfo((function(e){console.log(e)})),this.attachUpdateEvents(this.api),this.api.forEachDetailGridInfo((function(e){void 0!==e.api&&t.attachUpdateEvents(e.api)})),this.api.addEventListener("firstDataRendered",(function(e){return t.fitColumns()})),this.api.setRowData(this.state.rowData),this.gridOptions.preSelectedRows)this.api.selectIndex(this.gridOptions.preSelectedRows[a],!0,!0);if(this.isGridAutoHeightOn){var r,n=null===(r=this.gridContainerRef.current)||void 0===r?void 0:r.clientHeight;p.a.setFrameHeight(n)}null!==this.wsUrl&&this.wsUpdate(this.api)}},{key:"defineContainerHeight",value:function(){return this.isGridAutoHeightOn?{width:this.props.width}:{width:this.props.width,height:this.state.gridHeight}}},{key:"ClearRowSelectionButton",value:function(e){return e.clear_row_selection?Object(M.jsx)("button",{onClick:e.onClick,children:"Clear Row Selection"}):Object(M.jsx)("span",{})}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.args.reload_data?{rowData:JSON.parse(e.args.row_data),gridHeight:e.args.height,should_update:!0}:{gridHeight:e.args.height}}}]),a}(p.b),z=Object(p.c)(P);o.a.render(Object(M.jsx)(n.a.StrictMode,{children:Object(M.jsx)(z,{})}),document.getElementById("root"))}},[[344,1,2]]]);
//# sourceMappingURL=main.fb2c4a69.chunk.js.map